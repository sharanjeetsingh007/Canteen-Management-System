{"version":3,"sources":["services/orders.service.js","views/admin/Orders.js"],"names":["db","firestore","collection","OrdersDataService","item","add","id","value","doc","update","delete","AllOrders","props","onDataChange","bind","state","orders","unsubscribe","undefined","this","getAll","orderBy","onSnapshot","items","forEach","data","push","uid","username","date","status","total","order","setState","getUser","fields","key","_classes","hover","striped","clickableRows","scopedSlots","color","style","width","onClick","e","to","Component"],"mappings":"mMAEMA,E,OAAKC,EAAUC,WAAW,WAC1BC,E,sFACF,WACI,OAAOH,I,oBAGX,SAAOI,GACH,OAAOJ,EAAGK,IAAID,K,oBAGlB,SAAOE,EAAIC,GACP,OAAOP,EAAGQ,IAAIF,GAAIG,OAAOF,K,oBAG7B,SAAOD,GACH,OAAON,EAAGQ,IAAIF,GAAII,a,KAIX,QAAIP,G,oJCPbQ,E,kDAEF,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IACDC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,MAAQ,CACTC,OAAQ,IAGZ,EAAKC,iBAAcC,EAPJ,E,qDAUnB,WACIC,KAAKF,YAAcd,IAAkBiB,SAChCC,QAAQ,OAAQ,QAChBC,WAAWH,KAAKN,gB,kCAGzB,WACIM,KAAKF,gB,0BAGT,SAAaM,GACT,IAAIP,EAAS,GAEbO,EAAMC,SAAQ,SAAApB,GACV,IAAIE,EAAKF,EAAKE,GACVmB,EAAOrB,EAAKqB,OAEhBT,EAAOU,KAAK,CACRpB,GAAIA,EACJqB,IAAKF,EAAKE,IACVC,SAAUH,EAAKG,SACfC,KAAMJ,EAAKI,KACXC,OAAQL,EAAKK,OACbC,MAAON,EAAKM,MACZC,MAAOP,EAAKO,WAIpBb,KAAKc,SAAS,CACVjB,OAAQA,M,oBAIhB,WAGI,OADakB,cAOT,eAAC,IAAD,WACI,cAAC,IAAD,yBAGA,cAAC,IAAD,UACI,cAAC,IAAD,CACIX,MAAOJ,KAAKJ,MAAMC,OAClBmB,OAAQ,CACJ,CAAEC,IAAK,WAAYC,SAAU,oBAC7B,OACA,SACA,QACA,QACA,UAEJC,OAAK,EACLC,SAAO,EACPC,eAAa,EACbC,YAAe,CACX,MACI,SAACrC,GAAD,OACI,mCAAMA,EAAK2B,UAEnB,OACI,SAAC3B,GAAD,OACI,6BAEwB,YAAhBA,EAAK0B,QAAwB,qCAC7B,cAAC,IAAD,CAASY,MAAM,UAAUC,MAAoB,CAACC,MAAM,KAAMC,QAAS,SAACC,GAC5C3C,IAAkBM,OAAOL,EAAKE,GAAI,CAC9BqB,IAAKvB,EAAKuB,IACVC,SAAUxB,EAAKwB,SACfC,KAAMzB,EAAKyB,KACXC,OAAQ,SACRC,MAAO3B,EAAK2B,MACZC,MAAO5B,EAAK4B,SAPxC,SAUI,6CAEJ,cAAC,IAAD,CAASU,MAAM,SAASC,MAAoB,CAACC,MAAM,KAAMC,QAAS,SAACC,GAC3C3C,IAAkBM,OAAOL,EAAKE,GAAI,CAC9BqB,IAAKvB,EAAKuB,IACVC,SAAUxB,EAAKwB,SACfC,KAAMzB,EAAKyB,KACXC,OAAQ,SACRC,MAAO3B,EAAK2B,MACZC,MAAO5B,EAAK4B,SAPxC,SAUI,2DAtD5B,cAAC,IAAD,CAAUe,GAAG,e,GAlDTC,aAqHTrC","file":"static/js/12.7d0ec377.chunk.js","sourcesContent":["import { firestore } from \"../firebase\";\r\n\r\nconst db = firestore.collection(\"/orders\");\r\nclass OrdersDataService {\r\n    getAll() {\r\n        return db;\r\n    }\r\n\r\n    create(item) {\r\n        return db.add(item);\r\n    }\r\n\r\n    update(id, value) {\r\n        return db.doc(id).update(value);\r\n    }\r\n\r\n    delete(id) {\r\n        return db.doc(id).delete();\r\n    }\r\n}\r\n\r\nexport default new OrdersDataService();","import React, { Component } from 'react';\r\nimport OrdersDataService from '../../services/orders.service';\r\nimport {\r\n    CCard,\r\n    CCardBody,\r\n    CCardHeader,\r\n    CDataTable,\r\n    CButton,\r\n} from '@coreui/react';\r\n\r\nimport CIcon from '@coreui/icons-react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { getUser } from '../../common';\r\n\r\nclass AllOrders extends Component\r\n{\r\n    constructor(props) {\r\n        super(props);\r\n        this.onDataChange = this.onDataChange.bind(this);\r\n        this.state = {\r\n            orders: [],\r\n        };\r\n\r\n        this.unsubscribe = undefined;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.unsubscribe = OrdersDataService.getAll()\r\n            .orderBy(\"date\", \"desc\")\r\n            .onSnapshot(this.onDataChange);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.unsubscribe();\r\n    }\r\n\r\n    onDataChange(items) {\r\n        let orders = [];\r\n        let order_id = 1;\r\n        items.forEach(item => {\r\n            let id = item.id;\r\n            let data = item.data();\r\n            \r\n            orders.push({\r\n                id: id,\r\n                uid: data.uid,\r\n                username: data.username,\r\n                date: data.date,\r\n                status: data.status,\r\n                total: data.total,\r\n                order: data.order,\r\n            });\r\n        });\r\n\r\n        this.setState({\r\n            orders: orders,\r\n        });\r\n    }\r\n\r\n    render ()\r\n    {\r\n        const user = getUser();\r\n        if (!user)\r\n        {\r\n            return (<Redirect to=\"/login\" />);\r\n        }\r\n\r\n        return (\r\n            <CCard>\r\n                <CCardHeader>\r\n                    All Orders\r\n                </CCardHeader>\r\n                <CCardBody>\r\n                    <CDataTable\r\n                        items={this.state.orders}\r\n                        fields={[\r\n                            { key: 'username', _classes: 'font-weight-bold' },\r\n                            'date', \r\n                            'status', \r\n                            'total', \r\n                            'order',\r\n                            'action'\r\n                        ]}\r\n                        hover\r\n                        striped\r\n                        clickableRows\r\n                        scopedSlots = {{\r\n                            'total':\r\n                                (item) => (\r\n                                    <td>${item.total}</td>\r\n                                ),\r\n                            'action':\r\n                                (item) => (\r\n                                    <td>\r\n                                        {\r\n                                            item.status === \"pending\" && <>\r\n                                            <CButton color='primary' style={{height:36}, {width:120}} onClick={(e) => {\r\n                                                                    OrdersDataService.update(item.id, {\r\n                                                                        uid: item.uid,\r\n                                                                        username: item.username,\r\n                                                                        date: item.date,\r\n                                                                        status: \"accept\",\r\n                                                                        total: item.total,\r\n                                                                        order: item.order,\r\n                                                                    })\r\n                                                               }}>\r\n                                                <small>Accept</small>\r\n                                            </CButton>\r\n                                            <CButton color='danger' style={{height:36}, {width:120}} onClick={(e) => {\r\n                                                                    OrdersDataService.update(item.id, {\r\n                                                                        uid: item.uid,\r\n                                                                        username: item.username,\r\n                                                                        date: item.date,\r\n                                                                        status: \"cancel\",\r\n                                                                        total: item.total,\r\n                                                                        order: item.order,\r\n                                                                    })\r\n                                                                }}>\r\n                                                <small>Cancel</small>\r\n                                            </CButton></>\r\n                                        }\r\n                                    </td>\r\n                                )\r\n                            }}\r\n                        />\r\n                </CCardBody>\r\n            </CCard>\r\n        )\r\n    }\r\n}\r\n\r\nexport default AllOrders;"],"sourceRoot":""}