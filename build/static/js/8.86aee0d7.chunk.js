(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[8],{629:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"k",(function(){return f}));var r=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null},c=function(e,t){sessionStorage.setItem("token",e),sessionStorage.setItem("user",JSON.stringify(t))},a=function(e){var t=[];JSON.parse(sessionStorage.getItem("_products")||"[]").forEach((function(n,r){n.pid!==e?t.push(n):n.count>1&&(n.count--,n.total=n.price*n.count,t.push(n))})),sessionStorage.setItem("_products",JSON.stringify(t))},s=function(){var e=[];return JSON.parse(sessionStorage.getItem("_products")||"[]").forEach((function(t,n){e.push(t.name+" $"+t.price+" x "+t.count+" = $"+t.total)})),e},o=function(e,t,n,r){var c=JSON.parse(sessionStorage.getItem("_products")||"[]"),a=!1;if(c.forEach((function(t,n){t.pid===e&&(a=!0,t.count++,t.total=t.price*t.count)})),!a){var s={pid:e,name:t,price:n,imgurl:r,total:1*n,count:1};c.push(s)}sessionStorage.setItem("_products",JSON.stringify(c))},u=function(){return JSON.parse(sessionStorage.getItem("_products")||"[]")},i=function(){sessionStorage.setItem("_products",JSON.stringify([]))},l=function(){var e=JSON.parse(sessionStorage.getItem("_products")||"[]"),t=0;return e.forEach((function(e,n){t+=e.count})),t},d=function(){var e=JSON.parse(sessionStorage.getItem("_products")||"[]"),t=0;return e.forEach((function(e,n){t+=e.count*e.price})),t};function p(e,t,n){return new Promise((function(n,r){e().then(n).catch((function(c){setTimeout((function(){1!==t?p(e,t-1).then(n,r):r(c)}),5e3)}))}))}var f=function(e,t){var n="",r=!0;("name"!==e||t||(r=!1,n="Please enter your name."),"email"!==e||t||(r=!1,n="Please enter your email Address."),"email"===e&&"undefined"!==typeof t)&&(new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(t)||(r=!1,n="Please enter valid email address."));("phone"!==e||t||(r=!1,n="Please enter your phone number."),"phone"===e&&"undefined"!==typeof t)&&(new RegExp(/^\+[0-9\b]+$/).test(t)?t.length<10&&(r=!1,n="Please enter valid phone number."):(r=!1,n="Please enter only number."));return[r,n]}},630:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n(642),c=n.n(r),a=n(43),s=n(643),o=n(644),u=(n(646),n(649),o.a.initializeApp({apiKey:"AIzaSyCtv0SrPL04mrat1QIvWI8Q4e7yGoWgt1s",authDomain:"ict342-user.firebaseapp.com",databaseURL:"https://ict342-user-default-rtdb.firebaseio.com",projectId:"ict342-user",storageBucket:"ict342-user.appspot.com",messagingSenderId:"71121181583",appId:"1:71121181583:web:475e97730cdd78962189fa"}),o.a.auth),i=o.a.auth(),l=o.a.firestore(),d=function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,l.doc("users/".concat(t)).get();case 5:return n=e.sent,e.abrupt("return",Object(a.a)({uid:t},n.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(s.a)(c.a.mark((function e(t,n,r){var a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a=l.doc("users/".concat(t.uid)),e.next=5,a.get();case 5:if(e.sent.exists){e.next=18;break}return"","",s=t.email,e.prev=10,e.next=13,a.set({email:s,displayName:n,phoneNumber:r,rule:"",photoUrl:""});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.error("Error creating user document",e.t0);case 18:return e.abrupt("return",d(t.uid));case 19:case"end":return e.stop()}}),e,null,[[10,15]])})));return function(t,n,r){return e.apply(this,arguments)}}()},631:function(e,t,n){"use strict";var r=n(157),c=n(158),a=n(630).c.collection("/wallets"),s=function(){function e(){Object(r.a)(this,e)}return Object(c.a)(e,[{key:"getAll",value:function(){return a}},{key:"create",value:function(e){return a.add(e)}},{key:"update",value:function(e,t){return a.doc(e).update(t)}},{key:"delete",value:function(e){return a.doc(e).delete()}},{key:"getFromUser",value:function(e){return this.getAll().where("uid","==",e).get()}}]),e}();t.a=new s},681:function(e,t,n){"use strict";n.r(t);var r=n(164),c=n(1),a=n(627),s=n(628),o=n(630),u=n(20),i=n(629),l=n(631),d=n(17),p=void 0;t.default=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],f=t[1],m=Object(c.useState)(""),j=Object(r.a)(m,2),b=j[0],h=j[1],O=Object(c.useState)(""),g=Object(r.a)(O,2),x=g[0],v=g[1],w=Object(c.useState)(""),y=Object(r.a)(w,2),N=y[0],S=y[1],k=Object(c.useState)(""),P=Object(r.a)(k,2),E=P[0],I=P[1],C=Object(c.useState)(""),J=Object(r.a)(C,2),A=J[0],_=J[1],D=Object(c.useState)(null),R=Object(r.a)(D,2),B=R[0],U=R[1],z=function(){return""===E?(U("Please input User Name!"),!1):""===b?(U("Please input Email!"),!1):""===A?(U("Please input Phone Number!"),!1):""===x?(U("Please input Password!"),!1):x!==N?(U("Please confirm the Password!"),!1):(U(null),!0)},Q=function(e,t,n,r,c){e.preventDefault(),U(null);try{if(!1===z())return;window.recaptchaVerifier=new o.b.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:function(e){console.log("Ok: "+e),p.onPhoneNumberSubmit()}});var a=window.recaptchaVerifier;o.a.signInWithPhoneNumber(r,a).then((function(e){window.confirmationResult=e;var a=window.prompt("Enter OTP: ");e.confirm(a).then((function(e){var a=e.user;console.log("user: "+a),o.a.createUserWithEmailAndPassword(t,n).then((function(e){console.log(e),Object(o.d)(e.user,c,r).then((function(t){console.log("user: "+t),Object(i.j)(e.user.refreshToken,t),f(!0),l.a.create({uid:t.uid,username:t.displayName,total:100,payment:"Credit Card"})})).catch((function(e){console.log("error 01: "+e),U(e.message),f(!1)}))})).catch((function(e){console.log("error 02: "+e),U(e.message),f(!1)}))})).catch((function(e){console.log("error 03: "+e),U(e.message),f(!1)}))})).catch((function(e){console.log("error 04: "+e),U(e.message),f(!1)}))}catch(B){console.log("error 05: "+B),f(!1)}h(""),v(""),S(""),I(""),_(""),U(null),f(!1)},T=function(e){var t=e.currentTarget,n=t.name,c=t.value;if("userEmail"===n){var a=Object(i.k)("email",c),s=Object(r.a)(a,2),o=s[0],u=s[1];o?(U(null),h(c)):U(u)}else if("userPassword"===n)v(c);else if("userConfirm"===n)S(c),U(x!==c?"Please confirm the Password!":null);else if("displayName"===n){var l=Object(i.k)("name",c),d=Object(r.a)(l,2),p=d[0],f=d[1];p?(U(null),I(c)):U(f)}else if("phoneNumber"===n){var m=Object(i.k)("phone",c),j=Object(r.a)(m,2),b=j[0],O=j[1];b?(U(null),_(c)):U(O)}};return n?"admin"===Object(i.g)().rule?Object(d.jsx)(u.a,{to:"/dashboard"}):Object(d.jsx)(u.a,{to:"/today-menu"}):Object(d.jsx)("div",{className:"c-app c-default-layout flex-row align-items-center",children:Object(d.jsxs)(a.m,{children:[Object(d.jsx)(a.Q,{className:"justify-content-center",children:Object(d.jsx)(a.l,{md:"9",lg:"7",xl:"6",children:Object(d.jsxs)(a.g,{className:"mx-4",children:[Object(d.jsx)(a.h,{className:"p-4",children:Object(d.jsxs)(a.v,{children:[Object(d.jsx)("h1",{children:"Register"}),Object(d.jsx)("p",{className:"text-muted",children:"Create your account"}),Object(d.jsxs)(a.B,{className:"mb-3",children:[Object(d.jsx)(a.D,{children:Object(d.jsx)(a.E,{children:Object(d.jsx)(s.a,{name:"cil-user"})})}),Object(d.jsx)(a.A,{type:"text",placeholder:"User Name",name:"displayName",autoComplete:"userName",onChange:function(e){T(e)}})]}),Object(d.jsxs)(a.B,{className:"mb-3",children:[Object(d.jsx)(a.D,{children:Object(d.jsx)(a.E,{children:"@"})}),Object(d.jsx)(a.A,{type:"email",placeholder:"Email",name:"userEmail",autoComplete:"email",onChange:function(e){T(e)}})]}),Object(d.jsxs)(a.B,{className:"mb-3",children:[Object(d.jsx)(a.D,{children:Object(d.jsx)(a.E,{children:Object(d.jsx)(s.a,{name:"cil-phone"})})}),Object(d.jsx)(a.A,{type:"phonenumber",placeholder:"+12345678901 for Testing",name:"phoneNumber",autoComplete:"phoneNumber",onChange:function(e){T(e)}})]}),Object(d.jsxs)(a.B,{className:"mb-3",children:[Object(d.jsx)(a.D,{children:Object(d.jsx)(a.E,{children:Object(d.jsx)(s.a,{name:"cil-lock-locked"})})}),Object(d.jsx)(a.A,{type:"password",placeholder:"Password",name:"userPassword",autoComplete:"new-password",onChange:function(e){T(e)}})]}),Object(d.jsxs)(a.B,{className:"mb-4",children:[Object(d.jsx)(a.D,{children:Object(d.jsx)(a.E,{children:Object(d.jsx)(s.a,{name:"cil-lock-locked"})})}),Object(d.jsx)(a.A,{type:"password",placeholder:"Repeat password",name:"userConfirm",autoComplete:"new-password",onChange:function(e){T(e)}})]}),Object(d.jsx)(a.d,{color:"success",block:!0,onClick:function(e){Q(e,b,x,A,E)},children:"Create Account"})]})}),B&&B.length>0&&Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(a.i,{className:"p-4",children:Object(d.jsx)(a.Q,{children:Object(d.jsx)("small",{style:{color:"red"},children:B})})})})]})})}),Object(d.jsx)(a.Q,{children:Object(d.jsx)("div",{id:"recaptcha-container"})})]})})}}}]);
//# sourceMappingURL=8.86aee0d7.chunk.js.map